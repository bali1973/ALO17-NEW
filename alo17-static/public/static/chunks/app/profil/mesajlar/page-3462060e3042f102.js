(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[997],{4702:(e,t,s)=>{"use strict";s.d(t,{d:()=>i,t:()=>l});var a=s(95155),r=s(12115);let n=(0,r.createContext)(void 0);function i(){let e=(0,r.useContext)(n);if(!e)throw Error("useToast must be used within ToastProvider");return e}function l(e){let{children:t}=e,[s,i]=(0,r.useState)([]);return(0,a.jsxs)(n.Provider,{value:{showToast:function(e){let t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"info",s=Date.now();i(a=>[...a,{id:s,message:e,type:t}]),setTimeout(()=>{i(e=>e.filter(e=>e.id!==s))},3500)}},children:[t,(0,a.jsx)("div",{className:"fixed top-4 right-4 z-50 space-y-2",children:s.map(e=>(0,a.jsx)("div",{className:"px-4 py-2 rounded shadow text-white transition-all\n              ".concat("success"===e.type?"bg-green-600":"error"===e.type?"bg-red-600":"bg-blue-600"),children:e.message},e.id))})]})}},12926:(e,t,s)=>{"use strict";s.d(t,{A:()=>l,default:()=>o});var a=s(95155),r=s(12115),n=s(4702);let i=(0,r.createContext)(void 0);function l(){let e=(0,r.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e}function o(e){let{children:t}=e,[s,l]=(0,r.useState)(null),[o,c]=(0,r.useState)(!0);return(0,r.useEffect)(()=>{let e=localStorage.getItem("alo17-session");if(e)try{let t=JSON.parse(e);new Date(t.expires)>new Date?l(t):localStorage.removeItem("alo17-session")}catch(e){localStorage.removeItem("alo17-session")}c(!1)},[]),(0,a.jsx)(n.t,{children:(0,a.jsx)(i.Provider,{value:{session:s,setSession:e=>{l(e),e?localStorage.setItem("alo17-session",JSON.stringify(e)):localStorage.removeItem("alo17-session")},isLoading:o},children:t})})}},30759:(e,t,s)=>{Promise.resolve().then(s.bind(s,57361))},35695:(e,t,s)=>{"use strict";var a=s(18999);s.o(a,"useParams")&&s.d(t,{useParams:function(){return a.useParams}}),s.o(a,"usePathname")&&s.d(t,{usePathname:function(){return a.usePathname}}),s.o(a,"useRouter")&&s.d(t,{useRouter:function(){return a.useRouter}}),s.o(a,"useSearchParams")&&s.d(t,{useSearchParams:function(){return a.useSearchParams}})},57361:(e,t,s)=>{"use strict";s.d(t,{default:()=>l});var a=s(95155),r=s(12115),n=s(12926),i=s(35695);function l(){let{session:e,isLoading:t}=(0,n.A)(),s=(0,i.useRouter)(),[l,o]=(0,r.useState)("received"),[c,d]=(0,r.useState)([]),[u,m]=(0,r.useState)(!1),[h,x]=(0,r.useState)("");(0,r.useEffect)(()=>{e&&v(l)},[l,e]);let v=async e=>{m(!0),x("");try{let t=localStorage.getItem("alo17-session"),s={};t&&(s={Authorization:"Bearer ".concat(t)});let a=await fetch("/api/messages?type=".concat(e),{headers:{"Content-Type":"application/json",...s}}),r=await a.json();a.ok?d(r.messages):x(r.error||"Mesajlar y\xfcklenemedi.")}catch(e){x("Mesajlar y\xfcklenirken hata oluştu.")}m(!1)};return t?(0,a.jsx)("div",{className:"p-8 text-center",children:"Y\xfckleniyor..."}):e?(0,a.jsxs)("div",{className:"max-w-3xl mx-auto p-6",children:[(0,a.jsx)("h1",{className:"text-2xl font-bold mb-6",children:"Mesajlarım"}),(0,a.jsxs)("div",{className:"flex space-x-4 mb-6",children:[(0,a.jsx)("button",{className:"px-4 py-2 rounded ".concat("received"===l?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"),onClick:()=>o("received"),children:"Gelen Kutusu"}),(0,a.jsx)("button",{className:"px-4 py-2 rounded ".concat("sent"===l?"bg-blue-600 text-white":"bg-gray-200 text-gray-700"),onClick:()=>o("sent"),children:"G\xf6nderilenler"})]}),u&&(0,a.jsx)("div",{children:"Y\xfckleniyor..."}),h&&(0,a.jsx)("div",{className:"text-red-500 mb-4",children:h}),!u&&0===c.length&&(0,a.jsx)("div",{className:"text-gray-500",children:"Hi\xe7 mesaj yok."}),(0,a.jsx)("ul",{className:"space-y-4",children:c.map(e=>{var t,r;return(0,a.jsxs)("li",{className:"bg-white rounded shadow p-4 cursor-pointer hover:bg-blue-50",onClick:()=>{var t,a;let r="received"===l?e.senderId||(null==(t=e.sender)?void 0:t.id):e.receiverId||(null==(a=e.receiver)?void 0:a.id);s.push("/profil/mesajlar/MessageDetail?recipientId=".concat(r))},children:[(0,a.jsxs)("div",{className:"flex justify-between items-center mb-2",children:[(0,a.jsx)("span",{className:"font-semibold",children:"received"===l?e.senderName||(null==(t=e.sender)?void 0:t.name)||e.senderId:(null==(r=e.receiver)?void 0:r.name)||e.receiverId}),(0,a.jsx)("span",{className:"text-xs text-gray-400",children:new Date(e.createdAt).toLocaleString("tr-TR")})]}),(0,a.jsx)("div",{className:"mb-2",children:(0,a.jsx)("span",{className:"text-gray-700",children:e.content})}),e.listing&&(0,a.jsxs)("div",{className:"text-xs text-gray-500",children:["İlan: ",e.listing.title]})]},e.id)})})]}):(0,a.jsx)("div",{className:"p-8 text-center text-red-500",children:"Mesajlarınızı g\xf6r\xfcnt\xfclemek i\xe7in giriş yapmalısınız."})}}},e=>{var t=t=>e(e.s=t);e.O(0,[8441,1684,7358],()=>t(30759)),_N_E=e.O()}]);