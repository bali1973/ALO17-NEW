(()=>{var e={};e.id=2109,e.ids=[2109],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},24839:(e,r,t)=>{"use strict";t.r(r),t.d(r,{patchFetch:()=>v,routeModule:()=>k,serverHooks:()=>f,workAsyncStorage:()=>x,workUnitAsyncStorage:()=>h});var s={};t.r(s),t.d(s,{GET:()=>y,POST:()=>m});var o=t(96559),a=t(48088),i=t(37719),n=t(32190),l=t(29021),u=t(33873),c=t.n(u);let p=c().join(process.cwd(),"public","listings.json");async function d(){try{let e=await l.promises.readFile(p,"utf-8");return JSON.parse(e)}catch(e){return console.error("Dosya okuma hatası:",e),[]}}async function g(e){try{console.log("Dosya yazma başlıyor..."),console.log("Dosya yolu:",p);let r=c().dirname(p);console.log("Dizin yolu:",r),await l.promises.mkdir(r,{recursive:!0}),console.log("Dizin oluşturuldu/kontrol edildi");let t=JSON.stringify(e,null,2);console.log("JSON string oluşturuldu, uzunluk:",t.length),await l.promises.writeFile(p,t,"utf-8"),console.log("İlanlar başarıyla kaydedildi:",p);let s=await l.promises.stat(p);console.log("Dosya boyutu:",s.size,"bytes")}catch(e){throw console.error("Dosya yazma hatası:",e),console.error("Hata detayı:",e instanceof Error?e.stack:"Bilinmeyen hata"),Error(`İlanlar kaydedilemedi: ${e instanceof Error?e.message:String(e)}`)}}async function y(){let e=await d();return n.NextResponse.json(e)}async function m(e){try{console.log("POST /api/listings \xe7ağrıldı");let r=await e.json();if(console.log("Gelen veri:",JSON.stringify(r,null,2)),!r.title||!r.description||!r.price||!r.category)return console.log("Eksik alanlar:",{title:!!r.title,description:!!r.description,price:!!r.price,category:!!r.category}),n.NextResponse.json({error:"Başlık, a\xe7ıklama, fiyat ve kategori alanları zorunludur"},{status:400});let t=r.userRole||"user";console.log("Mevcut ilanlar okunuyor...");let s=await d();console.log("Mevcut ilan sayısı:",s.length);let o=s.length>0?Math.max(...s.map(e=>Number(e.id)||0))+1:1,a=new Date().toISOString(),i={...r,id:o,createdAt:a,status:"active",views:0,isPremium:!!r.isPremium,premiumFeatures:r.premiumFeatures||[],user:r.user||"Anonim",email:r.email||"",userRole:t};return console.log("Yeni ilan oluşturuluyor:",JSON.stringify(i,null,2)),s.push(i),console.log("İlan listeye eklendi, dosyaya yazılıyor..."),await g(s),console.log("İlan başarıyla oluşturuldu:",i.id),n.NextResponse.json(i,{status:201})}catch(e){return console.error("İlan oluşturma hatası:",e),n.NextResponse.json({error:"İlan oluşturulurken bir hata oluştu: "+(e instanceof Error?e.message:String(e))},{status:500})}}let k=new o.AppRouteRouteModule({definition:{kind:a.RouteKind.APP_ROUTE,page:"/api/listings/route",pathname:"/api/listings",filename:"route",bundlePath:"app/api/listings/route"},resolvedPagePath:"C:\\Users\\bali\\Desktop\\alo17_backup_2025-06-17_16-49-55\\src\\app\\api\\listings\\route.ts",nextConfigOutput:"standalone",userland:s}),{workAsyncStorage:x,workUnitAsyncStorage:h,serverHooks:f}=k;function v(){return(0,i.patchFetch)({workAsyncStorage:x,workUnitAsyncStorage:h})}},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},44870:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-route.runtime.prod.js")},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},78335:()=>{},96487:()=>{}};var r=require("../../../webpack-runtime.js");r.C(e);var t=e=>r(r.s=e),s=r.X(0,[4447,580],()=>t(24839));module.exports=s})();